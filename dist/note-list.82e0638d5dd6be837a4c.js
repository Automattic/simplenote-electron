"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5368],{61716:function(e,t,n){n.r(t),n.d(t,{NoteList:function(){return T},default:function(){return Q}});var s=n(41705),o=n(63696),l=n(27478),a=n(4452),r=n.n(a),i=n(80249),c=n(38634);function h(){return o.createElement("svg",{className:"icon-tag",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},o.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),o.createElement("path",{d:"M18.29 5.71v5.17l-7 7L6.12 12.71l7-7h5.17m2-2h-8L4 12a1 1 0 0 0 0 1.41L10.59 20A1 1 0 0 0 12 20l8.29-8.29v-8Zm-4.5 5.5a1 1 0 1 0-1-1A1 1 0 0 0 15.79 9.21Z"}))}var u=n(97099),d=n(64784),p=n(61943),m=()=>{var e=(0,i.d4)((e=>e.ui.collection)),t=(0,i.d4)((e=>e.ui.hasLoadedNotes)),n=(0,i.d4)((e=>e.ui.searchQuery)),s=(0,i.wA)(),l=()=>n.length?o.createElement("button",{onClick:()=>s(p.A.ui.createNote({content:n}))},'Create a new note titled "',n,'"'):o.createElement("button",{onClick:()=>s(p.A.ui.createNote())},"Create your first note"),{message:a,icon:r,button:m}=(e=>{var{collection:t,searchQuery:n}=e;if(n.length>0)return{message:"No Results",icon:null,button:l()};switch(t.type){case"tag":return{message:'No notes tagged "'.concat(t.tagName,'"'),icon:o.createElement(h,null),button:null};case"trash":return{message:"Your trash is empty",icon:o.createElement(u.A,null),button:null};case"untagged":return{message:"No untagged notes",icon:o.createElement(d.A,null),button:null};default:return{message:"",icon:o.createElement(c.A,null),button:l()}}})({collection:e,searchQuery:n});return o.createElement("div",{className:"note-list-placeholder"},o.createElement("div",{className:"no-notes-icon"},r),o.createElement("div",{className:"no-notes-message"},a),o.createElement("div",{className:"no-notes-button"},t&&m))};function g(){return o.createElement("svg",{className:"icon-published-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},o.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),o.createElement("path",{d:"M7.38 10.25L5.13 8.11l1.03-1.09 1.2 1.15 2.46-2.42 1.05 1.07L7.38 10.25zM13 0.93H3c-0.828 0-1.5 0.672-1.5 1.5l0 0v10.14c0 0.828 0.672 1.5 1.5 1.5h10c0.828 0 1.5-0.672 1.5-1.5V2.43C14.5 1.602 13.828 0.93 13 0.93L13 0.93zM3.5 12.07V4h9v8.07H3.5z"}))}function w(){return o.createElement("svg",{className:"icon-pinned-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},o.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),o.createElement("path",{d:"M4.41 10.17l-4-4 5.65-0.52L8.65 3.1 7.24 1.69l1.42-1.42 7.07 7.07 -1.42 1.42 -1.42-1.43 -2.56 2.58 -0.52 5.66 -4-4L3 14.41 1.59 13 4.41 10.17zM8.21 11.17L8.4 9l3.07-3.1 -1.4-1.41L7 7.6 4.87 7.79 8.21 11.17z"}))}function y(){return o.createElement("svg",{className:"icon-sync-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},o.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),o.createElement("path",{d:"M14 2v5h-0.09 -2.05H9l1.82-1.82C10.1 4.46 9.11 4 8 4 6.14 4 4.59 5.28 4.14 7H2.09C2.57 4.17 5.03 2 8 2c1.65 0 3.14 0.69 4.22 1.78L14 2zM8 12c-1.11 0-2.1-0.46-2.82-1.18L7 9H4.14 2.09 2v5l1.78-1.78C4.86 13.31 6.35 14 8 14c2.97 0 5.43-2.17 5.91-5h-2.05C11.41 10.72 9.86 12 8 12z"}))}var v=n(17243),N=n(73467),E=n.n(N),f=n(48940),b=(e,t)=>e.length>0&&t.length>0?e.reduce(((e,t)=>{var{filter:n,replacer:s}=t,o="string"==typeof n&&(0,f.C)(n),l=o&&o.length>0?new RegExp((0,v.escapeRegExp)(o),"gi"):n;return E()(e,l,s)}),t).map(((e,t)=>e&&"string"!=typeof e?o.cloneElement(e,{key:t}):e)):t,x=e=>({filter:e,replacer:e=>{if(e.length)return o.createElement("span",{className:"search-match"},e)}}),C=n(16742),A=n(51938),k=n(1962);class L extends o.Component{constructor(e){super(e),this.createdAt=Date.now()}componentDidUpdate(e){var t,n;(null===(t=e.note)||void 0===t?void 0:t.content)!==(null===(n=this.props.note)||void 0===n?void 0:n.content)&&this.props.invalidateHeight(),this.props.lastUpdated<1e3&&!this.updateScheduled&&(this.updateScheduled=setTimeout((()=>this.forceUpdate()),1e3))}componentWillUnmount(){clearTimeout(this.updateScheduled)}render(){var{displayMode:e,hasPendingChanges:t,isOffline:n,isOpened:s,lastUpdated:l,noteId:a,note:i,openNote:c,pinNote:h,searchQuery:u,style:d}=this.props;if(!i)return o.createElement("div",null,"Couldn't find note");var{title:p,preview:m}=(0,C.Cb)(i,u),v=i.systemTags.includes("pinned"),N=!!i.publishURL,E=l-this.createdAt>1e3&&Date.now()-l<1200,k=r()("note-list-item",{"note-list-item-selected":s,"note-list-item-pinned":v,"note-recently-updated":E,"published-note":N}),L=r()("note-list-item-pinner",{"note-list-item-pinned":v}),S=v?"Unpin note ".concat(p):"Pin note ".concat(p),D=(0,f.S)(u).map(x);return o.createElement("div",{style:d,className:k,role:"row"},o.createElement("div",{className:"note-list-item-content",role:"cell"},o.createElement("div",{className:"note-list-item-status"},o.createElement("button",{"aria-label":S,className:L,onClick:()=>h(a,!v)},o.createElement(w,null))),o.createElement("button",{"aria-label":"Edit note ".concat(p),className:"note-list-item-text focus-visible",onClick:()=>c(a)},o.createElement("div",{className:"note-list-item-title"},o.createElement("span",null,b(D,(0,A.yK)(p)))),"expanded"===e&&m.length>0&&o.createElement("div",{className:"note-list-item-excerpt"},(0,A.yK)(m).split("\n").map(((e,t)=>o.createElement(o.Fragment,{key:t},t>0&&o.createElement("br",null),b(D,e.slice(0,200)))))),"comfy"===e&&m.length>0&&o.createElement("div",{className:"note-list-item-excerpt"},b(D,(0,A.yK)(m).slice(0,200)))),o.createElement("div",{className:"note-list-item-status-right"},t&&o.createElement("span",{className:r()("note-list-item-pending-changes",{"is-offline":n})},o.createElement(y,null)),N&&o.createElement("span",{className:"note-list-item-published-icon"},o.createElement(g,null)))))}}var S={openNote:p.A.ui.openNote,pinNote:p.A.data.pinNote},D=(0,i.Ng)(((e,t)=>{var n,{noteId:s}=t;return{displayMode:e.settings.noteDisplay,hasPendingChanges:k.hf(e,s),isOffline:"offline"===e.simperium.connectionStatus,isOpened:e.ui.openedNote===s,lastUpdated:null!==(n=e.simperium.lastRemoteUpdate.get(s))&&void 0!==n?n:-1/0,note:e.data.notes.get(s),searchQuery:e.ui.searchQuery}}),S)(L),O=n(16663);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,s.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=(e,t)=>{switch(e.type){case"tag":return t;case"trash":return"Trash";case"untagged":return"Untagged Notes";default:return"All Notes"}};class T extends o.Component{constructor(){super(...arguments),(0,s.A)(this,"state",{heightCache:new l.jS({defaultHeight:135,fixedWidth:!0,keyMapper:e=>{var{filteredNotes:t,searchQuery:n,tagResultsFound:s}=this.props;return 0===s&&0===t.length?"no-notes":0===n.length||0===s?t[e]:0===e?"tag-suggestions":1===e?"notes-header":t[e-2]}}),lastNoteDisplay:null,windowWidth:null}),(0,s.A)(this,"list",(0,o.createRef)()),(0,s.A)(this,"handleShortcut",(e=>{if(this.props.keyboardShortcuts){var{ctrlKey:t,metaKey:n,shiftKey:s}=e,o=e.key.toLowerCase(),{isSmallScreen:l,showNoteList:a}=this.props,r=t||n;return r&&s&&"k"===o?(this.props.selectNoteAbove(),e.stopPropagation(),e.preventDefault(),!1):r&&s&&"j"===o?(this.props.selectNoteBelow(),e.stopPropagation(),e.preventDefault(),!1):l&&r&&s&&"l"===o?(this.props.toggleNoteList(),e.stopPropagation(),e.preventDefault(),!1):!l||!a||"Enter"!==o||(this.props.openNote(),e.stopPropagation(),e.preventDefault(),!1)}})),(0,s.A)(this,"toggleShortcuts",(e=>{e?window.addEventListener("keydown",this.handleShortcut,!0):window.removeEventListener("keydown",this.handleShortcut,!0)}))}componentDidMount(){this.toggleShortcuts(!0)}componentWillUnmount(){this.toggleShortcuts(!1)}render(){var{collection:e,filteredNotes:t,noteDisplay:n,onEmptyTrash:s,openedNote:a,openedTag:i,searchQuery:c,showTrash:h,tagResultsFound:u}=this.props,{heightCache:d}=this.state,p=((e,t,n)=>0===t.length||0===n?e:["tag-suggestions","notes-header",...e.length>0?e:["no-notes"]])(t,c,u),g=p.findIndex((e=>e===a)),w=((e,t)=>{var{heightCache:n}=t;return t=>{var{index:s,key:a,parent:r,style:i}=t,c=e[s];return"no-notes"===c?o.createElement(l.dl,{cache:n,columnIndex:0,key:"no-notes",parent:r,rowIndex:s},o.createElement("div",{className:"note-list is-empty",style:I(I({},i),{},{height:200})},o.createElement("span",{className:"note-list-placeholder"},"No Notes"))):"tag-suggestions"===c||"notes-header"===c?"tag-suggestions"===c?o.createElement(l.dl,{cache:n,columnIndex:0,key:"tag-suggestions",parent:r,rowIndex:s},o.createElement(O.Ay,{style:I({},i)})):o.createElement(l.dl,{cache:n,columnIndex:0,key:"notes-header",parent:r,rowIndex:s},o.createElement("div",{className:"note-list-header",style:I({},i)},"Notes")):o.createElement(l.dl,{cache:n,columnIndex:0,key:a,parent:r,rowIndex:s},o.createElement(D,{invalidateHeight:()=>n.clear(s,0),noteId:c,style:i}))}})(p,{heightCache:d}),y=0===p.length,v=o.createElement("div",{className:"note-list-empty-trash"},o.createElement("button",{type:"button",className:"button button-borderless button-danger",onClick:s},"Empty Trash"));return o.createElement("div",{className:r()("note-list",{"is-empty":y})},y?o.createElement(m,null):o.createElement(o.Fragment,null,o.createElement("div",{className:"note-list-items ".concat(n)},o.createElement(l.t$,null,(t=>{var{height:s,width:a}=t;return o.createElement(l.B8,{"aria-label":j(e,i),ref:this.list,estimatedRowSize:126,height:s,noteDisplay:n,notes:p,rowCount:p.length,rowHeight:d.rowHeight,rowRenderer:w,scrollToIndex:g,tabIndex:null,width:a})}))),h&&v))}}(0,s.A)(T,"displayName","NoteList"),(0,s.A)(T,"getDerivedStateFromProps",((e,t)=>(t.heightCache.clear(0),t.heightCache.clear(1),t.heightCache.clear(2),e.noteDisplay!==t.lastNoteDisplay||e.windowWidth!==t.windowWidth?(t.heightCache.clearAll(),{lastNoteDisplay:e.noteDisplay,windowWidth:e.windowWidth}):null)));var M={onEmptyTrash:p.A.ui.emptyTrash,openNote:p.A.ui.openNote,selectNoteAbove:p.A.ui.selectNoteAbove,selectNoteBelow:p.A.ui.selectNoteBelow,toggleNoteList:p.A.ui.toggleNoteList},Q=(0,i.Ng)((e=>({collection:e.ui.collection,isSmallScreen:k.Qv(e),keyboardShortcuts:e.settings.keyboardShortcuts,noteDisplay:e.settings.noteDisplay,filteredNotes:e.ui.filteredNotes,openedNote:e.ui.openedNote,openedTag:k.Q5(e),searchQuery:e.ui.searchQuery,showNoteList:e.ui.showNoteList,showTrash:k.Iy(e),tagResultsFound:e.ui.tagSuggestions.length,windowWidth:e.browser.windowWidth})),M)(T)}}]);