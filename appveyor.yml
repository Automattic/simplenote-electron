environment:
  CSC_ENC_KEY: 
    # secure: ef2yQX3A9dZPQzS6r7oY7pUtzK/ICiUUDZZsh/K7eT59a4BVdxqCfIZU812MmqQHK/iC4cYLdTW+tWHrq9bJquzQgHGjgB0cTBwS9KUjyOg=
    secure: wTsJKe1a/gIpmgVVfCHDFw==
  CSC_KEY_PASSWORD:
    secure: Sz53shy7P4kPzBKa9shHTw==
  CSC_LINK: .\resources\certificates\win.p12
  GH_TOKEN:
    secure: m2UKPC/0BUlPZ63dLNIbuoFRNW448BzVrlW6TnjtoLtXCqY+lz9+aKTP4miCwQEy
  TESTVAR:
    secure: sGfE6uPg+RfWnuyRSk/mjg==

image: Visual Studio 2017

# install:
#   - ps: Install-Product node 10
#   - cinst make
#   - npm install

before_build:
  - ps: echo 'secret is ->  "'$env:CSC_ENC_KEY'"'
  - ps: echo 'testvar is -> "'$env:TESTVAR'"'
  - ps: echo 'CSC_LINK is -> "'$env:CSC_LINK'"'
  - ps: >-
      if ($env:CSC_ENC_KEY) {
        echo "Secret has been decrypted";
      }
  - ps: ls .\resources\certificates\ 

build_script:
  - ps: echo $env:TESTVAR
  - ps: >-
      if (!$env:CSC_ENC_KEY) {
        echo "Remove CSC_LINK";
        Remove-Item env:CSC_LINK;
      }
  - ps: echo 'CSC_LINK is -> "'$env:CSC_LINK'"'

# artifacts:
#   - path: release\*.exe
#   - path: release\*.appx
#   - path: release\*.yml

# cache:
#   - node_modules
#   - '%APPDATA%\npm-cache'
#   - C:\ProgramData\chocolatey\bin -> appveyor.yml
#   - C:\ProgramData\chocolatey\lib -> appveyor.yml